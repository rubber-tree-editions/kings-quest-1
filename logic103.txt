#include "vars.txt"

LOGIC__HEADER

#define oGOAT o13

if (fROOM_SCRIPT_EXECUTED) {
  load.view(14);
  animate.obj(oGOAT);
  set.view(oGOAT, 14);
  get.posn(oEGO, v60, v61);
  object.on.land(oGOAT);
  if (vROOM_NO == 7 && vPREV_ROOM_NO == 8 && v61 < 65) {
    position(oGOAT, 1, 42);
    stop.motion(oGOAT);
    stop.cycling(oGOAT);
    ignore.horizon(oGOAT);
    ignore.blocks(oGOAT);
    set(f40);
    draw(oGOAT);
    goto(ATRIVER);
  }
  if (vROOM_NO == 17 && vPREV_ROOM_NO == 18 && v61 < 65) {
    position(oGOAT, 1, 45);
    stop.motion(oGOAT);
    stop.cycling(oGOAT);
    ignore.horizon(oGOAT);
    ignore.blocks(oGOAT);
    set(f43);
    draw(oGOAT);
    goto(ATRIVER);
  }
  if (vROOM_NO == 17 && vPREV_ROOM_NO == 32 && v60 < 50) {
    position(oGOAT, 1, 45);
    stop.motion(oGOAT);
    stop.cycling(oGOAT);
    ignore.horizon(oGOAT);
    ignore.blocks(oGOAT);
    set(f43);
    draw(oGOAT);
    goto(ATRIVER);
  }
  if (v61 > 100) {
    v61 += 1;
  }
  else {
    v61 -= 1;
  }
  position.v(oGOAT, v60, v61);
  v107 = 1;
  step.size(oGOAT, v107);
  draw(oGOAT);
  follow.ego(oGOAT, 10, f207);
}
distance(oEGO, oGOAT, v40);
if (v40 > 35) {
  v107 = 2;
  step.size(oGOAT, v107);
}
else {
  v107 = 1;
  step.size(oGOAT, v107);
}
if (!fGOAT_COMPANION) {
  return;
}
if (fGAME_OVER) {
  normal.motion(oGOAT);
  stop.motion(oGOAT);
  stop.cycling(oGOAT);
  return;
}
if (f40 || f43) {
  goto(ATRIVER);
}
if (f76) {
  ignore.blocks(oGOAT);
  return;
}
observe.blocks(oGOAT);
v41--;
if (v41 == 1) {
  if (v40 < 21) {
    set(f207);
  }
  else if (!f207 && v94 <= 0) {
    v41 = 0;
    start.cycling(oGOAT);
    start.motion(oGOAT);
    follow.ego(oGOAT, 10, f207);
  }
}
if (f207) {
  reset(f207);
  v41 = 9;
  normal.motion(oGOAT);
  stop.motion(oGOAT);
  stop.cycling(oGOAT);
}
if (v40 > 20 && v94 > 0 && !f210) {
  if (vROOM_NO != 1 && vROOM_NO != 2 && vROOM_NO != 41 && vROOM_NO != 33 && vROOM_NO != 34 && vROOM_NO != 32 && vROOM_NO != 25 && vROOM_NO != 26 && vROOM_NO != 39) {
    print("The goat does not mind getting its feet wet,but will not swim in the water.  You should go back and lead the goat around the water.");
  }
  set(f210);
  start.cycling(oGOAT);
  wander(oGOAT);
}
if (f210 && v40 < 25 && v94 <= 0) {
  reset(f210);
  follow.ego(oGOAT, 10, f207);
}
if (fEGO_INVISIBLE && !f42) {
  set(f42);
  print("The goat, not being able to see you, wanders off.");
  reset(fGOAT_COMPANION);
  wander(oGOAT);
  if (vOBJECT_EDGE_CODE != 0) {
    erase(oGOAT);
  }
}
return;
ATRIVER:
  distance(oEGO, oGOAT, v40);
  if (f43 && v94 > 0 && !f210) {
    set(f210);
    print("The goat does not mind getting its feet wet,but will not swim in the water.  You should go back and lead the goat around the water.");
  }
  if (f43 && f210 && v40 < 25 && v94 <= 0) {
    reset(f210);
  }
  return;

LOGIC__FOOTER

