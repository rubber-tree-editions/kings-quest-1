#include "vars.txt"

LOGIC__HEADER

#define oOGRE o1

if (fROOM_SCRIPT_EXECUTED) {
  load.pic(vROOM_NO);
  draw.pic(vROOM_NO);
  discard.pic(vROOM_NO);
  if (fGOAT_COMPANION) {
    load.logics(LOGIC_GOAT);
  }
  if (vROOM_YOU_KILLED_THE_GOAT_IN == vROOM_NO) {
    add.to.pic(62, 0, 0, 60, 71, 0, 0);
  }
  LABEL35:
    set.horizon(42);
    random(0, 250, v62);
    if (v62 < 175) {
      load.sound(SND_VILLAIN);
      v31 = 2;
      step.size(oOGRE, v31);
      load.view(94);
      load.view(95);
      load.view(2);
      animate.obj(oOGRE);
      set.view(oOGRE, 2);
      set(f20);
    }
  LABEL69:
    if (f20) {
      LABEL75:
        random(0, 250, v70);
        if (v70 > 90) {
          goto(LABEL75);
        }
    }
  LABEL89:
    draw(oEGO);
    show.pic();
}
v70--;
if (v70 == 1) {
  set(f145);
  set(f146);
  position(oOGRE, 40, 51);
  set(f21);
  set(f135);
  sound(SND_VILLAIN, fSOUND_END_MARKER);
  draw(oOGRE);
  if (!fGOAT_COMPANION) {
    print("Watch out!!!  There is an ogre nearby!  He will crush you in his strong arms if he catches you.");
    follow.ego(oOGRE, 7, f156);
  }
  if (fGOAT_COMPANION) {
    wander(oOGRE);
    set(f23);
    print("Watch out!!!  There is an ogre nearby!  He will crush you in his strong arms if he catches you.");
    print("Lucky for you that ogres are afraid of goats. This one decides to leave you alone.");
  }
}
LABEL145:
  if (fSOUND_END_MARKER) {
    reset(fSOUND_END_MARKER);
    reset(f135);
  }
LABEL155:
  if (!f21) {
    reset(f145);
    reset(f146);
    if (said("anyword", "ogre")) {
      print("There is no ogre here.");
    }
    if (said("throw", "dagger") && fCARRYING_DAGGER) {
      print("OK.  You drop the dagger.");
      reset(fCARRYING_DAGGER);
      set(fDAGGER_LOST);
      drop("dagger");
      vSCORE -= 5;
    }
  }
LABEL201:
  if (f156) {
    reset(f156);
    if (fEGO_INVISIBLE) {
      print("Fortunately, you are invisible and the ogre can't see you.");
      wander(oOGRE);
      set(f23);
      goto(LABEL284);
    }
    if (fPROTECTED_BY_SPELL) {
      print("You are very fortunate that your protective spell is still working.");
      wander(oOGRE);
      set(f23);
      goto(LABEL284);
    }
    if (fCARRYING_SHIELD) {
      print("With the magic shield, no harm will come to you.");
      wander(oOGRE);
      set(f23);
      goto(LABEL284);
    }
    if (fEGO_TINY) {
      print("The ogre's vision is not keen enough to see you.");
      wander(oOGRE);
      set(f23);
      goto(LABEL284);
    }
    set(f24);
    v30 = 10;
    program.control();
    stop.motion(oEGO);
    erase(oOGRE);
    set.view(oEGO, 94);
  }
LABEL282:
  v30--;
LABEL284:
  if (f23 && vOBJECT_EDGE_CODE != 0) {
    erase(oOGRE);
    reset(f23);
    reset(f21);
  }
LABEL300:
  if (v30 == 1) {
    print("You were warned to be careful around this fierce creature!  Maybe next time you will be able to elude the beast.");
    get.posn(oEGO, v60, v61);
    erase(oEGO);
    set.view(oEGO, 95);
    set.view(oOGRE, 2);
    position.v(oEGO, v60, v61);
    position.v(oOGRE, v60, v61);
    draw(oOGRE);
    draw(oEGO);
    stop.motion(oOGRE);
    stop.cycling(oOGRE);
    set(fGAME_OVER);
  }
LABEL339:
  if (f21) {
    if (said("examine", "ogre")) {
      print("That is a ferocious looking beast.  Please keep your distance!");
    }
    if (said("murder", "ogre")) {
      print("Ogres are practically indestructible.");
    }
    LABEL369:
      if (said("examine", "stumps")) {
        print("At one time these were very pretty trees.");
      }
    LABEL381:
      if (said("pet", "ogre")) {
        print("Do you really want to try that?");
      }
    LABEL393:
      if (said("examine", "flowers")) {
        print("The delightful wild flowers brighten up your day.");
      }
    LABEL405:
      if (said("smell", "flowers")) {
        if (posn(oEGO, 22, 86, 114, 167)) {
          print("Their perfume is joyful, sweet, and light.");
          goto(LABEL432);
        }
        print("You need to be a little closer to smell the flowers.");
      }
    LABEL432:
      if (said("talk", "ogre") || said("hello") || said("say", "hello")) {
        print("Ogres don't talk, they growl!");
      }
    LABEL456:
      if (said("throw", "dagger") && fCARRYING_DAGGER) {
        print("The dagger is of little use against such a mean creature.  I would save it if I were you.");
      }
  }
LABEL470:
  if (vEGO_EDGE_CODE != EDGE_NONE) {
    reset(f145);
    reset(f146);
  }
LABEL482:
  if (f24) {
    goto(LABEL551);
  }
LABEL491:
  if (vEGO_EDGE_CODE == EDGE_HORIZON && v30 <= 0) {
    new.room(3);
  }
  if (vEGO_EDGE_CODE == EDGE_RIGHT && v30 <= 0) {
    new.room(47);
  }
LABEL517:
  if (vEGO_EDGE_CODE == EDGE_LEFT && v30 <= 0) {
    new.room(45);
  }
LABEL530:
  if (vEGO_EDGE_CODE == EDGE_BOTTOM && v30 <= 0) {
    new.room(35);
  }
LABEL543:
  if (fGOAT_COMPANION) {
    call(LOGIC_GOAT);
  }
LABEL551:
  return;

LOGIC__FOOTER

